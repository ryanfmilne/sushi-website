---
import Layout from "../layouts/Layout.astro";

// Hardcoded specials data
const specials = [
  {
    title: "Date Night Special",
    startDate: new Date("2025-05-01"),
    endDate: new Date("2025-06-30"),
    description:
      "Enjoy a romantic evening with our special three-course menu for two. Includes appetizer, two entrees, and a shared dessert.",
    price: 79.99,
    regularPrice: 99.99,
    featured: true,
    active: true,
  },
  {
    title: "Weekday Lunch Express",
    startDate: new Date("2025-04-15"),
    endDate: new Date("2025-07-15"),
    description:
      "Perfect for busy professionals! Choose from a select menu of quick lunch options, served within 15 minutes or it's free.",
    price: 15.99,
    regularPrice: 18.99,
    featured: false,
    active: true,
  },
  {
    title: "Happy Hour",
    startDate: new Date("2025-01-01"),
    endDate: new Date("2025-12-31"),
    description:
      "Join us Monday through Friday, 4-7 PM for half-price appetizers and $2 off all drinks.",
    price: null,
    regularPrice: null,
    featured: false,
    active: true,
  },
  {
    title: "Spring Tasting Menu",
    startDate: new Date("2025-03-01"),
    endDate: new Date("2025-04-30"),
    description:
      "Celebrate the flavors of spring with our special seasonal tasting menu featuring the freshest local ingredients.",
    price: 49.99,
    regularPrice: 59.99,
    featured: false,
    active: false,
  },
];

// Separate active and past specials
const activeSpecials = specials.filter((special) => special.active);
const pastSpecials = specials.filter((special) => !special.active);
---

<Layout title="Specials & Promotions">
  <div class="bg-stone-100 py-8">
    <div class="container mx-auto px-4">
      <h1 class="text-3xl md:text-4xl font-bold text-center mb-4">
        Specials & Promotions
      </h1>
      <p class="text-center text-stone-600 max-w-2xl mx-auto mb-8">
        Discover our latest special offers, seasonal dishes, and limited-time
        promotions.
      </p>

      <!-- Current Specials -->
      {
        activeSpecials.length > 0 ? (
          <div class="mb-12">
            <h2 class="text-2xl font-semibold mb-6">Current Offers</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {activeSpecials.map((special) => (
                <div
                  class={`bg-white rounded-lg shadow-md overflow-hidden ${special.featured ? "border-2 border-amber-500" : ""}`}>
                  <div class="p-4">
                    <div class="flex flex-col gap-1 mb-3">
                      <h3 class="text-lg font-semibold">{special.title}</h3>
                      <div class="text-sm text-stone-500">
                        <span>
                          {special.startDate.toLocaleDateString("en-US", {
                            month: "short",
                            day: "numeric",
                          })}{" "}
                          -
                          {special.endDate.toLocaleDateString("en-US", {
                            month: "short",
                            day: "numeric",
                          })}
                        </span>
                      </div>
                    </div>

                    <p class="text-stone-600 text-sm mb-3">
                      {special.description}
                    </p>

                    <div class="flex items-center gap-2">
                      {special.price && (
                        <span class="text-amber-600 font-medium text-lg">
                          ${special.price.toFixed(2)}
                        </span>
                      )}
                      {special.regularPrice && special.price && (
                        <span class="text-stone-500 line-through text-sm">
                          ${special.regularPrice.toFixed(2)}
                        </span>
                      )}
                      {special.featured && (
                        <span class="bg-amber-100 text-amber-800 text-xs font-medium px-2 py-0.5 rounded ml-auto">
                          Featured
                        </span>
                      )}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        ) : (
          <div class="text-center py-8 mb-8 bg-white rounded-lg shadow-sm">
            <p class="text-lg text-stone-600">
              There are no active specials at the moment. Check back soon for
              new offers!
            </p>
          </div>
        )
      }

      <!-- Stay Updated Section -->
      <div class="bg-amber-50 rounded-lg p-6 md:p-8 mb-12">
        <div class="max-w-3xl mx-auto">
          <h2 class="text-2xl font-semibold mb-4 text-center">Stay Updated</h2>
          <p class="text-center text-stone-600 mb-6">
            Sign up for our newsletter to be the first to know about new
            specials, events, and seasonal offerings.
          </p>

          <form
            class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto"
            id="newsletter-form">
            <input
              type="email"
              placeholder="Your email address"
              required
              class="flex-grow px-4 py-3 rounded-md border border-stone-300 focus:outline-none focus:ring-amber-500 focus:border-amber-500"
            />
            <button
              type="submit"
              class="whitespace-nowrap bg-amber-600 hover:bg-amber-700 text-white px-6 py-3 rounded-md font-medium transition-colors">
              Subscribe
            </button>
          </form>
        </div>
      </div>

      <!-- Past Specials -->
      {
        pastSpecials.length > 0 && (
          <div>
            <h2 class="text-2xl font-semibold mb-6">Past Offers</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 opacity-70">
              {pastSpecials.map((special) => (
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                  <div class="p-4">
                    <div class="flex flex-col gap-1 mb-3">
                      <h3 class="text-lg font-semibold">{special.title}</h3>
                      <div class="text-sm text-stone-500">
                        <span>
                          {special.startDate.toLocaleDateString("en-US", {
                            month: "short",
                            day: "numeric",
                          })}{" "}
                          -
                          {special.endDate.toLocaleDateString("en-US", {
                            month: "short",
                            day: "numeric",
                          })}
                        </span>
                      </div>
                    </div>

                    <p class="text-stone-600 text-sm mb-3">
                      {special.description}
                    </p>

                    <div class="flex items-center gap-2">
                      {special.price && (
                        <span class="text-amber-600 font-medium text-lg">
                          ${special.price.toFixed(2)}
                        </span>
                      )}
                      {special.regularPrice && special.price && (
                        <span class="text-stone-500 line-through text-sm">
                          ${special.regularPrice.toFixed(2)}
                        </span>
                      )}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )
      }
    </div>
  </div>
</Layout>

<script>
  // Basic form submission handling
  document
    .getElementById("newsletter-form")
    ?.addEventListener("submit", function (event) {
      event.preventDefault();
      alert(
        "Thank you for subscribing! This form is not functional in this demo, but would be connected to an email service in production."
      );

      // Reset the form
      const form = event.target as HTMLFormElement;
      form.reset();
    });
</script>
